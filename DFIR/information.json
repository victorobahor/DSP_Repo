{"description":"Digital Forensic and Incident Response Lab","goal":"<p>The goal of this lab is to understand digital forensic and basic SIEM management and configuration.</p>\n<p>Asset:</p>\n<ul>\n<li>Wazuh: <a href=\"https://193.20.44.11/\">https://193.20.44.11/</a></li>\n<li>Forensic Lab: <a href=\"http://193.20.44.2:3000/\">http://193.20.44.2:3000/</a> Access the tools in /tools folder</li>\n<li>TheHive: <a href=\"http://193.20.44.7:9000/\">http://193.20.44.7:9000/</a></li>\n<li>Cortex: <a href=\"http://193.20.44.6:9001/\">http://193.20.44.6:9001/</a></li>\n<li>Elastic: <a href=\"http://193.20.44.5:9200/\">http://193.20.44.5:9200/</a></li>\n</ul>\n<p>Foresince Lab:</p>\n<p>Investigating Data Leakage Case</p>\n<p><strong>Scenario Overview</strong></p>\n<p>&lsquo;Iaman Informant&rsquo; was working as a manager of the technology development division at a famous international company OOO that developed state-of-the-art technologies and gadgets.<br /><br />One day, at a place which &lsquo;Mr. Informant&rsquo; visited on business, he received an offer from &lsquo;Spy Conspirator&rsquo; to leak of sensitive information related to the newest technology. Actually, &lsquo;Mr. Conspirator&rsquo; was an employee of a rival company, and &lsquo;Mr. Informant&rsquo; decided to accept the offer for large amounts of money, and began establishing a detailed leakage plan.<br /><br />&lsquo;Mr. Informant&rsquo; made a deliberate effort to hide the leakage plan. He discussed it with &lsquo;Mr. Conspirator&rsquo; using an e-mail service like a business relationship. He also sent samples of confidential information though personal cloud storage.<br /><br />After receiving the sample data, &lsquo;Mr. Conspirator&rsquo; asked for the direct delivery of storage devices that stored the remaining (large amounts of) data. Eventually, &lsquo;Mr. Informant&rsquo; tried to take his storage devices away, but he and his devices were detected at the security checkpoint of the company. And he was suspected of leaking the company data.<br /><br />At the security checkpoint, although his devices (a USB memory stick and a CD) were briefly checked (protected with portable write blockers), there was no evidence of any leakage. And then, they were immediately transferred to the digital forensics laboratory for further analysis.<br /><br />The information security policies in the company include the following:</p>\n<ol>\n<li>Confidential electronic files should be stored and kept in the authorized external storage devices and the secured network drives.</li>\n<li>Confidential paper documents and electronic files can be accessed only within the allowed time range from 10:00 AM to 16:00 PM with the appropriate permissions.</li>\n<li>Non-authorized electronic devices such as laptops, portable storages, and smart devices cannot be carried onto the company.</li>\n<li>All employees are required to pass through the &lsquo;Security Checkpoint&rsquo; system.</li>\n<li>All storage devices such as HDD, SSD, USB memory stick, and CD/DVD are forbidden under the &lsquo;Security Checkpoint&rsquo; rules.</li>\n</ol>\n<p>In addition, although the company managed separate internal and external networks and used DRM (Digital Rights Management) / DLP (Data Loss Prevention) solutions for their information security, &lsquo;Mr. Informant&rsquo; had sufficient authority to bypass them. He was also very interested in IT (Information Technology), and had a slight knowledge of digital forensics.<br /><br />In this scenario, find any evidence of the data leakage, and any data that might have been generated from the suspect&rsquo;s electronic devices.</p>\n<p><strong>Target Systems and Devices</strong></p>\n<p>Personal Computer (PC):</p>\n<p>Type&nbsp;&nbsp;&nbsp; Virtual System</p>\n<p>CPU&nbsp;&nbsp;&nbsp; 1 Processer (2 Core)</p>\n<p>RAM&nbsp;&nbsp;&nbsp; 2,048 MB</p>\n<p>HDD Size&nbsp;&nbsp;&nbsp; 20 GB</p>\n<p>File System&nbsp;&nbsp;&nbsp; NTFS</p>\n<p>IP Address&nbsp;&nbsp;&nbsp; 10.11.11.129</p>\n<p>Operating System&nbsp;&nbsp;&nbsp; Microsoft Windows 7 Ultimate (SP1)</p>\n<p>&nbsp;</p>\n<p>Removable Media #1 (RM#1)*:</p>\n<p>Type&nbsp;&nbsp;&nbsp; USB removable storage device</p>\n<p>Serial No.&nbsp;&nbsp;&nbsp; 4C530012450531101593</p>\n<p>Size&nbsp;&nbsp;&nbsp; 4 GB</p>\n<p>File System&nbsp;&nbsp;&nbsp; exFAT</p>\n<p>&nbsp;</p>\n<p>Removable Media #2:</p>\n<p>Type&nbsp;&nbsp;&nbsp; USB removable storage device</p>\n<p>Serial No.&nbsp;&nbsp;&nbsp;&nbsp;4C530012550531106501</p>\n<p>Size&nbsp;&nbsp;&nbsp; 4 GB</p>\n<p>File System&nbsp;&nbsp;&nbsp; FAT32</p>\n<p>&nbsp;</p>\n<p>Removable Media #3:</p>\n<p>Type&nbsp;&nbsp;&nbsp; CD-R</p>\n<p>Size&nbsp;&nbsp;&nbsp; 700 MB</p>\n<p>File System&nbsp;&nbsp;&nbsp; UDF</p>\n<p>&nbsp;</p>\n<p>Acquired Data Information</p>\n<p><br />Personal Computer (PC) &ndash; 'DD' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/pc/cfreds_2015_data_leakage_pc.7z.001\">pc.7z.001</a>, <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/pc/cfreds_2015_data_leakage_pc.7z.002\">pc.7z.002</a>, <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/pc/cfreds_2015_data_leakage_pc.7z.003\">pc.7z.003</a> (total 5.05 GB compressed by 7zip) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; FTK Imager 3.4.0.1<br />Image Format&nbsp;&nbsp;&nbsp; converted from VMDK</p>\n<p><br />Personal Computer (PC) &ndash; 'EnCase' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/pc/cfreds_2015_data_leakage_pc.E011\">pc.E01</a>, <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/pc/cfreds_2015_data_leakage_pc.E02\">pc.E02</a>, <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/pc/cfreds_2015_data_leakage_pc.E03\">pc.E03</a>, <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/pc/cfreds_2015_data_leakage_pc.E04\">pc.E04</a> (total 7.28 GB compressed by EnCase) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; EnCase Imager 7.10.00.103<br />Image Format&nbsp;&nbsp;&nbsp; E01 (Expert Witness Compression Format) converted from VMDK</p>\n<p><br />Removable Media #1 (RM#1) &ndash; 'EnCase' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/rm%231/cfreds_2015_data_leakage_rm%231.E01\">rm#1.E01</a> (total 74.5 MB compressed by EnCase) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; FTK Imager 3.3.0.5 (write-blocked by Tableau USB Bridge T8-R2)<br />Image Format&nbsp;&nbsp;&nbsp; E01 (Expert Witness Compression Format)</p>\n<p>Removable Media #2 (RM#2) &ndash; 'DD' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/rm%232/cfreds_2015_data_leakage_rm%232.7z\">rm#2.7z </a>(total 219 MB compressed by 7zip) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; FTK Imager 3.3.0.5 (write-blocked by Tableau USB Bridge T8-R2)<br />Image Format&nbsp;&nbsp;&nbsp; DD</p>\n<p><br />Removable Media #2 (RM#2) &ndash; 'EnCase' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/rm%232/cfreds_2015_data_leakage_rm%232.E01\">rm#2.E01</a> (total 243 MB compressed by EnCase) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; EnCase Imager 7.09.00.111 (write-blocked by Tableau USB Bridge T8-R2)<br />Image Format&nbsp;&nbsp;&nbsp; E01 (Expert Witness Compression Format)</p>\n<p><br />Removable Media #3 (RM#3) &ndash; 'Raw / CUE' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/rm%233/cfreds_2015_data_leakage_rm%233_type1.7z\">rm#3-type1.7z</a> (total 92.8 MB compressed by 7zip) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; FTK Imager 3.3.0.5<br />Image Format&nbsp;&nbsp;&nbsp; RAW ISO / CUE (sometimes BIN / CUE)*</p>\n<p>Removable Media #3 (RM#3) &ndash; 'DD' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/rm%233/cfreds_2015_data_leakage_rm%233_type2.7z\">rm#3-type2.7z</a> (total 78.6 MB compressed by 7zip) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; FTK Imager 3.3.0.5 + bchunk (http://he.fi/bchunk)<br />Image Format&nbsp;&nbsp;&nbsp; DD converted from &lsquo;RAW ISO + CUE&rsquo;</p>\n<p><br />Removable Media #3 (RM#3) &ndash; 'EnCase' Image<br />Download Links&nbsp;&nbsp;&nbsp; <a href=\"https://cfreds-archive.nist.gov/data_leakage_case/images/rm%233/cfreds_2015_data_leakage_rm%233_type3.E01\">rm#3-type3.E01</a> (total 90.2 MB compressed by EnCase) - hash<br />Imaging S/W&nbsp;&nbsp;&nbsp; EnCase Imager 7.09.00.111<br />Image Format&nbsp;&nbsp;&nbsp; E01 (Expert Witness Compression Format)</p>\n<p><strong>Questions</strong><br />What are the hash values (MD5 &amp; SHA-1) of all images?<br />Does the acquisition and verification hash value match?<br />Identify the partition information of PC image.<br />Explain installed OS information in detail.<br />(OS name, install date, registered owner&hellip;)<br />What is the timezone setting?<br />What is the computer name?<br />List all accounts in OS except the system accounts: Administrator, Guest, systemprofile, LocalService, NetworkService. (Account name, login count, last logon date&hellip;)<br />Who was the last user to logon into PC?<br />When was the last recorded shutdown date/time?<br />Explain the information of network interface(s) with an IP address assigned by DHCP.<br />What applications were installed by the suspect after installing OS?<br />List application execution logs.<br />(Executable path, execution time, execution count...)<br />List all traces about the system on/off and the user logon/logoff.<br />(It should be considered only during a time range between 09:00 and 18:00 in the timezone from Question 4.)<br />What web browsers were used?<br />Identify directory/file paths related to the web browser history.<br />What websites were the suspect accessing? (Timestamp, URL...)<br />List all search keywords using web browsers. (Timestamp, URL, keyword...)<br />List all user keywords at the search bar in Windows Explorer. (Timestamp, Keyword)<br />What application was used for e-mail communication?<br />Where is the e-mail file located?<br />What was the e-mail account used by the suspect?<br />List all e-mails of the suspect. If possible, identify deleted e-mails.<br />(You can identify the following items: Timestamp, From, To, Subject, Body, and Attachment)<br />[Hint: just examine the OST file only.]<br />List external storage devices attached to PC.<br />Identify all traces related to &lsquo;renaming&rsquo; of files in Windows Desktop.<br />(It should be considered only during a date range between 2015-03-23 and 2015-03-24.)<br />[Hint: the parent directories of renamed files were deleted and their MFT entries were also overwritten. Therefore, you may not be able to find their full paths.]<br />What is the IP address of company&rsquo;s shared network drive?<br />List all directories that were traversed in &lsquo;RM#2&rsquo;.<br />List all files that were opened in 'RM#2&rsquo;.<br />List all directories that were traversed in the company&rsquo;s network drive.<br />List all files that were opened in the company&rsquo;s network drive.<br />Find traces related to cloud services on PC.<br />(Service name, log files...)<br />What files were deleted from Google Drive?<br />Find the filename and modified timestamp of the file.<br />[Hint: Find a transaction log file of Google Drive.]<br />Identify account information for synchronizing Google Drive.<br />What a method (or software) was used for burning CD-R?<br />When did the suspect burn CD-R?<br />[Hint: It may be one or more times.]<br />What files were copied from PC to CD-R?<br />[Hint: Just use PC image only. You can examine transaction logs of the file system for this task.]<br />What files were opened from CD-R?<br />Identify all timestamps related to a resignation file in Windows Desktop.<br />[Hint: the resignation file is a DOCX file in NTFS file system.]<br />How and when did the suspect print a resignation file?<br />Where are &lsquo;Thumbcache&rsquo; files located?<br />Identify traces related to confidential files stored in Thumbcache.<br />(Include &lsquo;256&rsquo; only)<br />Where are Sticky Note files located?<br />Identify notes stored in the Sticky Note file.<br />Was the &lsquo;Windows Search and Indexing&rsquo; function enabled? How can you identify it?<br />If it was enabled, what is a file path of the &lsquo;Windows Search&rsquo; index database?<br />What kinds of data were stored in Windows Search database?<br />Find traces of Internet Explorer usage stored in Windows Search database.<br />(It should be considered only during a date range between 2015-03-22 and 2015-03-23.)<br />List the e-mail communication stored in Windows Search database.<br />(It should be considered only during a date range between 2015-03-23 and 2015-03-24.)<br />List files and directories related to Windows Desktop stored in Windows Search database.<br />(Windows Desktop directory: \\Users\\informant\\Desktop\\)<br />Where are Volume Shadow Copies stored? When were they created?<br />Find traces related to Google Drive service in Volume Shadow Copy.<br />What are the differences between the current system image (of Question 29 ~ 31) and its VSC?<br />What files were deleted from Google Drive?<br />Find deleted records of cloud_entry table inside snapshot.db from VSC.<br />(Just examine the SQLite database only. Let us suppose that a text based log file was wiped.)<br />[Hint: DDL of cloud_entry table is as follows.]<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CREATE TABLE cloud_entry<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (doc_id TEXT, filename TEXT, modified INTEGER, created INTEGER, acl_role INTEGER,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doc_type INTEGER, removed INTEGER, size INTEGER, checksum TEXT, shared INTEGER,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resource_type TEXT, PRIMARY KEY (doc_id));<br />Why can&rsquo;t we find Outlook&rsquo;s e-mail data in Volume Shadow Copy?<br />Examine &lsquo;Recycle Bin&rsquo; data in PC.<br />What actions were performed for anti-forensics on PC at the last day '2015-03-25'?<br />Recover deleted files from USB drive &lsquo;RM#2&rsquo;.<br />What actions were performed for anti-forensics on USB drive &lsquo;RM#2&rsquo;?<br />[Hint: this can be inferred from the results of Question 53.]<br />What files were copied from PC to USB drive &lsquo;RM#2&rsquo;?<br />Recover hidden files from the CD-R &lsquo;RM#3&rsquo;.<br />How to determine proper filenames of the original files prior to renaming tasks?<br />What actions were performed for anti-forensics on CD-R &lsquo;RM#3&rsquo;?<br />Create a detailed timeline of data leakage processes.<br />List and explain methodologies of data leakage performed by the suspect.<br />Create a visual diagram for a summary of results.</p>","solution":"","readme":"","author":"vic"}
